<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒ—æµ·é“ âœˆï¸</title>
    <style>
        :root {
            --primary: #FF9AA2; /* æ«»èŠ±ç²‰ */
            --primary-dark: #FF808A;
            --secondary: #B5EAD7; /* æ·ºç¶  */
            --accent: #FFDAC1; /* æè‰² */
            --text: #4A4A4A;
            --bg: #FFF9F9;
            --white: #ffffff;
            --gray: #f5f5f5;
            --warning: #FFF4E5;
            --warning-text: #B45309;
            --danger: #FEE2E2;
            --danger-text: #991B1B;
            --cold: #E0F2FE; /* å†°è—è‰² */
            --cold-text: #0369A1;
            --love: #FFF0F5; /* æˆ€æ„›ç²‰ */
            --love-text: #D63384;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            line-height: 1.6;
            padding-bottom: 60px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: var(--white);
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0,0,0,0.05);
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary), #FFB7B2);
            padding: 25px 20px;
            color: white;
            text-align: center;
            border-bottom-left-radius: 25px;
            border-bottom-right-radius: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(255, 154, 162, 0.3);
            position: relative;
        }

        h1 { margin: 0; font-size: 1.5rem; font-weight: 700; }
        .subtitle { font-size: 0.95rem; opacity: 0.95; margin-top: 5px; font-weight: bold; background: rgba(255,255,255,0.2); display: inline-block; padding: 2px 10px; border-radius: 10px;}
        
        .cloud-status {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 0.8rem;
            background: rgba(255,255,255,0.2);
            padding: 2px 8px;
            border-radius: 10px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            padding: 0 15px;
            gap: 10px;
            margin-bottom: 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            background: var(--white);
            padding-top: 10px;
            padding-bottom: 10px;
        }

        .tab-btn {
            flex: 1;
            padding: 12px;
            border: none;
            background: var(--gray);
            border-radius: 12px;
            font-size: 1rem;
            color: #888;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 10px rgba(255, 154, 162, 0.4);
        }

        /* Views */
        .view { display: none; padding: 0 20px; animation: fadeIn 0.3s ease; }
        .view.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- Checklist Styles --- */
        .progress-container {
            background: #eee;
            border-radius: 10px;
            height: 12px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        .progress-bar {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.4s ease;
        }
        .progress-text {
            text-align: right; font-size: 0.85rem; color: var(--primary);
            font-weight: bold; margin-bottom: 15px;
        }
        .input-group { display: flex; gap: 10px; margin-bottom: 20px; }
        input[type="text"] {
            flex: 1; padding: 12px; border: 2px solid #eee; border-radius: 12px;
            font-size: 1rem; outline: none;
        }
        input[type="text"]:focus { border-color: var(--primary); }
        button.add-btn {
            background: var(--primary); color: white; border: none; width: 45px;
            border-radius: 12px; font-size: 1.5rem; cursor: pointer;
        }
        button.add-btn:disabled { background: #ccc; cursor: not-allowed; }

        ul { list-style: none; padding: 0; }
        li {
            background: white; border: 1px solid #f5f5f5; margin-bottom: 8px;
            padding: 12px 15px; border-radius: 12px; display: flex;
            align-items: center; justify-content: space-between;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
            transition: opacity 0.3s;
        }
        li.completed .text { text-decoration: line-through; color: #bbb; }
        .check-area { display: flex; align-items: center; gap: 12px; flex: 1; cursor: pointer; }
        .custom-checkbox {
            width: 22px; height: 22px; border: 2px solid var(--primary);
            border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;
            transition: all 0.2s;
        }
        li.completed .custom-checkbox { background: var(--primary); }
        li.completed .custom-checkbox::after { content: 'âœ“'; color: white; font-size: 14px; }
        .tag { font-size: 0.7rem; padding: 2px 8px; border-radius: 10px; background: #eee; color: #666; margin-bottom: 4px; display: inline-block; }
        .tag.urgent { background: #FFB7B2; color: #fff; font-weight: bold; }
        .item-text-wrapper { display: flex; flex-direction: column; }
        .delete-btn { background: none; border: none; color: #eee; font-size: 1.5rem; padding: 0 10px; cursor: pointer; }
        .delete-btn:hover { color: var(--primary); }

        /* --- Accordion Guide Styles --- */
        details {
            background: white;
            border: 1px solid #eee;
            border-radius: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.03);
            overflow: hidden;
            transition: all 0.3s;
        }

        details[open] {
            border-color: var(--secondary);
            box-shadow: 0 4px 12px rgba(181, 234, 215, 0.4);
        }

        summary {
            padding: 15px;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            list-style: none;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #fff;
        }

        summary::-webkit-details-marker { display: none; }
        summary::after { content: '+'; font-size: 1.5rem; color: var(--primary); font-weight: 300; }
        details[open] summary::after { content: '-'; }
        details[open] summary { border-bottom: 1px solid #f0f0f0; background: #fafafa;}

        .step-content { padding: 20px; background: #fff; }
        .guide-step { position: relative; padding-left: 20px; margin-bottom: 15px; border-left: 2px solid #eee; }
        .guide-step strong { display: block; color: #333; margin-bottom: 4px; }
        .guide-step p { margin: 0; font-size: 0.95rem; color: #666; }
        
        .highlight-box {
            background: #FFF5F5;
            border-left: 4px solid var(--primary);
            padding: 10px;
            margin: 10px 0;
            font-size: 0.9rem;
            color: #555;
            border-radius: 4px;
        }

        .vjw-guide {
            background: #F0F7FF;
            padding: 15px;
            border-radius: 10px;
            margin-top: 10px;
            border: 1px solid #BEE3F8;
        }

        .money-saving-tip {
            background: var(--warning);
            color: var(--warning-text);
            padding: 15px;
            border-radius: 10px;
            margin-top: 10px;
            font-size: 0.95rem;
            border: 1px solid #FDBA74;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .love-tip {
            background: var(--love);
            color: var(--love-text);
            padding: 15px;
            border-radius: 10px;
            margin-top: 10px;
            font-size: 0.95rem;
            border: 1px solid #F8B4D9;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .danger-alert {
            background: var(--danger);
            color: var(--danger-text);
            padding: 10px;
            border-radius: 8px;
            margin-top: 8px;
            font-size: 0.9rem;
            font-weight: bold;
            border: 1px solid #FCA5A5;
        }

        .weather-card {
            background: var(--cold);
            color: var(--cold-text);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 1px solid #BAE6FD;
            text-align: center;
        }

        .weather-temp {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .uniqlo-tip {
            border: 2px solid #E60012; /* Uniqlo Red */
            color: #E60012;
            background: #fff;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .laundry-tip {
            background: #F0FFF4;
            border: 1px solid #C6F6D5;
            color: #2F855A;
            padding: 12px;
            border-radius: 8px;
            margin-top: 12px;
            font-size: 0.9rem;
        }

        .reset-btn { color: #999; background: none; border: 1px solid #ddd; padding: 8px 16px; border-radius: 20px; font-size: 0.85rem; cursor: pointer; margin-top: 30px; display: block; margin-left: auto; margin-right: auto;}
        
        /* Loading Overlay */
        #loadingOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 2000;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            color: var(--primary);
        }

        /* Modal */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 200; }
        .modal { background: white; padding: 25px; border-radius: 15px; width: 80%; max-width: 320px; text-align: center; }
        .modal-btns { display: flex; gap: 10px; margin-top: 20px; }
        .btn { padding: 10px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; flex: 1; }
        .btn-confirm { background: var(--primary); color: white; }
        .btn-cancel { background: #eee; color: #666; }

    </style>
</head>
<body>

<div id="loadingOverlay">
    <h2>â˜ï¸ é€£ç·šä¸­...</h2>
    <p>æ­£åœ¨åŒæ­¥é›²ç«¯è³‡æ–™åº«</p>
</div>

<div class="container">
    <header>
        <h1>âœˆï¸ åŒ—æµ·é“</h1>
        <div class="subtitle">1/21 (äºŒ) ~ 1/25 (å…­) | 5å¤©4å¤œ</div>
        <div class="cloud-status" id="cloudStatus">é€£ç·šä¸­...</div>
    </header>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('checklist')">âœ… æº–å‚™æ¸…å–®</button>
        <button class="tab-btn" onclick="switchTab('guide')">ğŸ“˜ å…¨ç¨‹æ”»ç•¥</button>
    </div>

    <!-- View 1: Checklist -->
    <div id="view-checklist" class="view active">
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div class="progress-text" id="progressText">æº–å‚™é€²åº¦ï¼š0%</div>

        <div class="input-group">
            <input type="text" id="itemInput" placeholder="æ–°å¢å¾…è¾¦äº‹é …...">
            <button class="add-btn" id="addBtn" disabled>+</button>
        </div>

        <ul id="itemList">
            <!-- Items injected by JS -->
        </ul>

        <button class="reset-btn" onclick="showResetModal()">âš ï¸ æ¢å¾©é è¨­æ¸…å–®</button>
    </div>

    <!-- View 2: Full Guide -->
    <div id="view-guide" class="view">
        <p style="text-align: center; color: #666; font-size: 0.9rem; margin-bottom: 20px;">ğŸ‘‡ é»æ“Šæ¨™é¡Œå±•é–‹æ­¥é©Ÿ ğŸ‘‡</p>

        <!-- Stage 1 -->
        <details open>
            <summary>ç¬¬ 1 éšæ®µï¼šå‡ºç™¼å‰æº–å‚™</summary>
            <div class="step-content">
                <div class="guide-step">
                    <strong>1. æª¢æŸ¥è­·ç…§</strong>
                    <p>ç¢ºèªæ•ˆæœŸé‚„æœ‰ 6 å€‹æœˆä»¥ä¸Šã€‚</p>
                </div>
                <div class="guide-step" style="border-left-color: #FFB7B2;">
                    <strong>2. é è¨‚æ©Ÿç¥¨ & é£¯åº— (æœ€ç·Šæ€¥!)</strong>
                    <p><strong>èœ‚èœœ</strong>çš„å®¿èˆä¸èƒ½ä½ï¼å¦³å¿…é ˆè‡ªå·±è¨‚é£¯åº—ã€‚</p>
                    <p>1æœˆæ˜¯æ»‘é›ªæ—ºå­£ï¼Œä½å®¿éå¸¸æ»¿ï¼Œ<strong>ç¾åœ¨ç«‹åˆ»å»è¨‚æˆ¿</strong>ã€‚</p>
                    
                    <!-- MONEY SAVING TIP -->
                    <div class="money-saving-tip">
                        <strong>ğŸ’¸ æ©Ÿç¥¨ 3 è¬å¤ªè²´ï¼Ÿè½‰æ©ŸçœéŒ¢æ³•ï¼</strong><br>
                        <p style="margin-bottom:5px;">åˆ¥è²·é‚£ç¨® 20 å°æ™‚çš„ç¥¨ï¼Œé‚£æ˜¯ã€Œéš”å¤œè½‰æ©Ÿã€ï¼è«‹è©¦è©¦çœ‹é€™æ¨£è²·ï¼š</p>
                        <ul style="padding-left: 20px; margin: 5px 0;">
                            <li><strong>ç¬¬ä¸€æ®µï¼š</strong>å°åŒ— -> æ±äº¬ (æˆç”°/ç¾½ç”°) <br><span style="color:#666; font-size:0.85rem;">(ç´„ 3-4 å°æ™‚)</span></li>
                            <li><strong>ä¼‘æ¯ï¼š</strong>é ç•™ 3-4 å°æ™‚è½‰æ©Ÿ (åƒå€‹é£¯å‰›å¥½)</li>
                            <li><strong>ç¬¬äºŒæ®µï¼š</strong>æ±äº¬ -> æœ­å¹Œ (æ–°åƒæ­²) <br><span style="color:#666; font-size:0.85rem;">(ç´„ 1.5 å°æ™‚)</span></li>
                        </ul>
                        <div class="danger-alert">
                            âš ï¸ æ–°æ‰‹æ³¨æ„ï¼š<br>
                            1. ä¸è¦è²·åˆ°ã€Œæ›æ©Ÿå ´ã€çš„ (ä¾‹å¦‚ æˆç”°é£›ä¾†ï¼Œå»è¦è·‘å»ç¾½ç”°é£›)ã€‚<br>
                            2. ç¸½æ™‚é•· 8-10 å°æ™‚æœ€å®‰å…¨ï¼Œè¶…é 15 å°æ™‚çš„ä¸è¦è²·ï¼
                        </div>
                    </div>

                </div>
                <div class="guide-step">
                    <strong>3. ä¿®æ”¹ Visit Japan Web (VJW)</strong>
                    <p>å¡«å¯«çš„åœ°å€å¿…é ˆæ˜¯ã€Œå¦³è¨‚çš„é£¯åº—åœ°å€ã€ã€‚</p>
                    <div class="vjw-guide">
                        <strong>ğŸ“Œ VJW å¡«å¯«é‡é» (ä½é£¯åº—)ï¼š</strong><br>
                        <ul>
                            <li><strong>æŠµé”æ—¥æœŸï¼š</strong>1æœˆ21æ—¥</li>
                            <li><strong>åœ°å€/é›»è©±ï¼š</strong>å¡«é£¯åº—çš„è³‡æ–™</li>
                            <li><strong>ä½å®¿åç¨±ï¼š</strong>å¡«é£¯åº—çš„è‹±æ–‡åå­—</li>
                        </ul>
                        <br>
                        <strong>âš ï¸ åƒè¬ä¸è¦å¡«èœ‚èœœçš„å®¿èˆåœ°å€ (æœƒè¢«å¡é—œ)ã€‚</strong>
                    </div>
                </div>
                <div class="guide-step">
                    <strong>4. å‚™ä»½è³‡æ–™</strong>
                    <p>æˆªåœ–ï¼šé£¯åº—è¨‚æˆ¿ç´€éŒ„ã€é£¯åº—åœ°å€é›»è©±ã€å›ç¨‹æ©Ÿç¥¨ã€‚</p>
                </div>
            </div>
        </details>

        <!-- Stage 2 -->
        <details>
            <summary>ç¬¬ 2 éšæ®µï¼šæ•´ç†è¡Œæ (ç”œå¿ƒæ¸›é‡ç‰ˆ â¤ï¸)</summary>
            <div class="step-content">
                
                <!-- LOVE TIP -->
                <div class="love-tip">
                    <strong>ğŸ’– èœ‚èœœèªªè¦è²·çµ¦å¦³ï¼è¡Œæç®±è¦ç•™ç©ºï¼</strong><br>
                    æ—¢ç„¶å»æ—¥æœ¬æœƒè²·æ–°è¡£æœï¼Œ<strong>è¡Œæå¸¶æœ€å°‘å°±å¥½</strong>ã€‚<br>
                    å»ç¨‹ç©¿è‘—é‚£ä»¶ã€ŒåŠ çµ¨æ£‰è¤²ã€æœ€èˆ’æœï¼ŒæŠŠç‰›ä»”è¤²å¿˜äº†å§ï¼
                </div>

                <div class="highlight-box">
                    ğŸ’¡ å‡ºç™¼ç©¿æ­å»ºè­°ï¼š<br>
                    ä¸Šèº«ï¼šç™¼ç†±è¡£ + èˆ’æœè¡›è¡£ + ç¾½çµ¨å¤–å¥—<br>
                    ä¸‹èº«ï¼š<strong>åŠ çµ¨æ£‰è¤²</strong> (é£›æ©Ÿä¸Šè¶…å¥½ç¡)<br>
                    é…ä»¶ï¼šé›ªé´ã€åœå·¾ã€æ¯›å¸½
                </div>

                <div class="guide-step">
                    <strong>1. å¿…å‚™è¡£ç‰© (5å¤©æ¥µç°¡ç‰ˆ)</strong>
                    <p>é•·ç‰ˆç¾½çµ¨å¤–å¥— x1 (ç©¿è‘—å»)</p>
                    <p>é˜²æ»‘é˜²æ°´é›ªé´ x1 (ç©¿è‘—å»)</p>
                    <p>ä¸­å±¤æ¯›è¡£/åˆ·æ¯›å¤–å¥— x2 (æ›¿æ›ç©¿)</p>
                    <p>äº®è‰²åœå·¾ x1 (æ‹ç…§å¥½çœ‹!)</p>
                    <p>æ¯›å¸½ã€æ‰‹å¥—</p>
                    
                    <!-- UNIQLO TIP -->
                    <div class="uniqlo-tip">
                        ğŸ”¥ Uniqlo æ¡è³¼æ¸…å–® (å»ºè­°æ•¸é‡)ï¼š<br>
                        1. <strong>è¶…æ¥µæš–ç™¼ç†±è¡£ (Ultra Warm)</strong> x 1<br>
                        2. <strong>è¶…æ¥µæš–å…§æ­è¤² (Ultra Warm)</strong> x 1<br>
                        <span style="font-weight:normal; font-size:0.85rem; color:#333;">é€™å…©ä»¶ç•¶ä½œã€Œç¬¬äºŒå±¤çš®è†šã€ï¼Œä¸ç”¨è²·å¤šï¼</span>
                    </div>

                    <!-- LAUNDRY TIP -->
                    <div class="laundry-tip">
                        <strong>ğŸ’¡ çœéŒ¢è¡›ç”Ÿè¡“ï¼š</strong><br>
                        ç™¼ç†±è¤²è£¡é¢ç©¿ä¸€èˆ¬å…§è¤²ï¼Œç™¼ç†±è¡£å¤–é¢å™´æ­¢æ±—åŠ‘ï¼Œæ™šä¸Šæ›èµ·ä¾†é€šé¢¨ã€‚<br>
                        5å¤©4å¤œå®Œå…¨ä¸ç”¨æ´—ï¼Œä¸ç”¨æ€•é«’ï¼
                    </div>

                </div>
                <div class="guide-step">
                    <strong>2. æ‰‹æ©Ÿä¿å‘½æ‹›</strong>
                    <p>ğŸ‘‰ <strong>æ‰‹æ©Ÿæœƒå‡åˆ°è‡ªå‹•é—œæ©Ÿï¼</strong></p>
                    <p>ä¸€å®šè¦æº–å‚™ã€Œæš–æš–åŒ…ã€è²¼åœ¨æ‰‹æ©ŸèƒŒé¢ï¼Œæˆ–æ˜¯ä¸ç”¨æ™‚æŠŠæ‰‹æ©Ÿæ”¾åœ¨é è¿‘èº«é«”çš„å…§å´å£è¢‹ä¿æº«ã€‚</p>
                </div>
            </div>
        </details>

        <!-- Stage 3 -->
        <details>
            <summary>ç¬¬ 3 éšæ®µï¼š1/21 å°ç£æ©Ÿå ´å‡ºç™¼ ğŸ‡¹ğŸ‡¼</summary>
            <div class="step-content">
                <div class="highlight-box">
                    ğŸ•’ é›–ç„¶é¿é–‹éå¹´ï¼Œä½†å‰›å¥½æ˜¯<strong>å¯’å‡ç¬¬ä¸€é€±</strong>ï¼Œå»ºè­°ææ—© 2.5~3 å°æ™‚åˆ°æ©Ÿå ´ã€‚
                </div>
                <div class="guide-step">
                    <strong>1. å ±åˆ° (Check-in)</strong>
                    <p>æ‰¾èˆªç©ºæ«ƒå°ï¼Œçµ¦è­·ç…§ï¼Œæ›å¤§è¡Œæç®±ã€‚</p>
                    <p><i>ç¢ºèªè¡Œæç®±éäº†Xå…‰æ©Ÿå†é›¢é–‹æ«ƒå°ã€‚</i></p>
                </div>
                <div class="guide-step">
                    <strong>2. å®‰å…¨æª¢æŸ¥ (Security)</strong>
                    <p>æ’éšŠæª¢æŸ¥éš¨èº«åŒ…ã€‚</p>
                    <p>ğŸ‘‰ æ°´å£ºçš„æ°´è¦å€’æ‰ï¼ç­†é›»ã€å¹³æ¿æ‹¿å‡ºä¾†ã€‚</p>
                </div>
                <div class="guide-step">
                    <strong>3. è­‰ç…§æŸ¥é©— (Immigration)</strong>
                    <p>èµ°ã€Œè‡ªå‹•é€šé—œã€é–˜é–€ï¼Œåˆ·è­·ç…§ã€çœ‹é¡é ­ï¼Œé€šéï¼</p>
                </div>
                <div class="guide-step">
                    <strong>4. å»ç™»æ©Ÿé–€ (Gate)</strong>
                    <p>çœ‹ç™»æ©Ÿè­‰ä¸Šçš„ Gate è™Ÿç¢¼ï¼Œå»é‚£é‚Šç­‰é£›æ©Ÿã€‚</p>
                </div>
            </div>
        </details>

        <!-- Stage 4 -->
        <details>
            <summary>ç¬¬ 4 éšæ®µï¼šæŠµé”æ—¥æœ¬ (æœ€ç·Šå¼µçš„ï¼)</summary>
            <div class="step-content">
                <div class="highlight-box">
                    ä¸è¦æ€•ï¼Œè·Ÿè‘—æŒ‡æ¨™ã€Œåˆ°ç€ (Arrival)ã€èµ°å°±å¥½ã€‚
                </div>
                <div class="guide-step">
                    <strong>1. æª¢ç–« (Quarantine)</strong>
                    <p>é€šå¸¸èµ°éå»é«”æº«æ²’å•é¡Œå°±é€šéã€‚</p>
                </div>
                <div class="guide-step">
                    <strong>2. å…¥å¢ƒå¯©æŸ¥ (Immigration)</strong>
                    <p>èµ°åˆ°å¤–åœ‹äººé€šé“ã€‚</p>
                    <p>ğŸ‘‰ å‡ºç¤º <strong>VJW QR Code</strong> + è­·ç…§ã€‚</p>
                    <p>ğŸ‘‰ å£“æŒ‡ç´‹ã€çœ‹é¡é ­æ‹ç…§ã€‚</p>
                    <p>ğŸ‘‰ å•ä¾†å¹¹å˜›ï¼Ÿå›ç­” "Sightseeing" (è§€å…‰)ã€‚</p>
                </div>
                <div class="guide-step">
                    <strong>3. æ‹¿è¡Œæ (Baggage)</strong>
                    <p>çœ‹è¢å¹•æ‰¾èˆªç­è™Ÿç¢¼ï¼Œå»è½‰ç›¤æ‹¿è¡Œæã€‚</p>
                </div>
                <div class="guide-step">
                    <strong>4. ç¨…é—œæª¢æŸ¥ (Customs)</strong>
                    <p>æ¨è‘—è¡Œæå¾€å‡ºå£èµ°ã€‚</p>
                    <p>ğŸ‘‰ å†æ¬¡æƒæ <strong>VJW QR Code</strong> (èµ°é›»å­ç”³å ±é€šé“)ã€‚</p>
                </div>
                <div class="guide-step">
                    <strong>ğŸ‰ æˆåŠŸå…¥å¢ƒï¼</strong>
                    <p>é–€æ‰“é–‹ï¼Œå°±å¯ä»¥å»æ­è»Šæ‰¾<strong>èœ‚èœœ</strong>äº†ï¼</p>
                </div>
            </div>
        </details>

        <!-- Stage 5 -->
        <details>
            <summary>ç¬¬ 5 éšæ®µï¼š1/25 å¿«æ¨‚å›å°ç£ ğŸ </summary>
            <div class="step-content">
                <div class="guide-step">
                    <strong>1. åˆ°æ—¥æœ¬æ©Ÿå ´</strong>
                    <p>æµç¨‹è·Ÿå°ç£ä¸€æ¨£ï¼šCheck-in -> å®‰æª¢ -> å‡ºå¢ƒå¯©æŸ¥ã€‚</p>
                </div>
                <div class="guide-step">
                    <strong>2. æŠµé”å°ç£</strong>
                    <p>ä¸‹é£›æ©Ÿ -> èµ°è‡ªå‹•é€šé—œå…¥å¢ƒ -> æ‹¿è¡Œæã€‚</p>
                </div>
                <div class="highlight-box">
                    ğŸš¨ <strong>çµ•å°ä¸å¯ä»¥å¸¶ï¼š</strong><br>
                    æ–°é®®æ°´æœã€è”¬èœã€è‚‰é¡è£½å“ (ç«è…¿ã€é¦™è…¸ã€æ²’ç†Ÿçš„è›‹)ã€‚<br>
                    è¢«æŠ“åˆ°ç½°éŒ¢ç½°å¾ˆé‡å–”ï¼
                </div>
            </div>
        </details>

    </div>
</div>

<!-- Modal -->
<div id="confirmModal" class="modal-overlay">
    <div class="modal">
        <h3>âš ï¸ ç¢ºå®šé‡ç½®ï¼Ÿ</h3>
        <p style="color:#666; font-size: 0.9rem; margin-bottom: 20px;">é€™æœƒåˆªé™¤å¦³æ‰€æœ‰çš„é›²ç«¯ç´€éŒ„ï¼Œæ¢å¾©æˆé è¨­å€¼ã€‚</p>
        <div class="modal-btns">
            <button class="btn btn-cancel" onclick="closeModal()">å–æ¶ˆ</button>
            <button class="btn btn-confirm" onclick="confirmReset()">ç¢ºå®šé‡ç½®</button>
        </div>
    </div>
</div>

<script type="module">
    // 1. Import Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, collection, addDoc, updateDoc, deleteDoc, doc, onSnapshot, query, orderBy, serverTimestamp, writeBatch, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    // 2. Configuration (User Provided)
    const firebaseConfig = {
        apiKey: "AIzaSyDFUGYOobmVxYFQMBYz1iQ4z1HIrdbTi8Q",
        authDomain: "travel-55c4b.firebaseapp.com",
        databaseURL: "https://travel-55c4b-default-rtdb.firebaseio.com",
        projectId: "travel-55c4b",
        storageBucket: "travel-55c4b.firebasestorage.app",
        messagingSenderId: "925227625640",
        appId: "1:925227625640:web:7966e45422a9979ff8a69d",
        measurementId: "G-N5V8NBGEHZ"
    };

    // 3. Initialize
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Default Data
    // Updated to reflect HOTEL requirement
    const defaultData = [
        { text: "é è¨‚æ©Ÿç¥¨ (ç¢ºèªè½‰æ©Ÿæ™‚é–“!!)", done: false, cat: "æœ€å„ªå…ˆ" },
        { text: "é è¨‚é£¯åº— (èœ‚èœœå®¿èˆä¸èƒ½ä½)", done: false, cat: "æœ€å„ªå…ˆ" },
        { text: "è¡Œæç®±æ¸…ç©ºä¸€åŠ (è£æ–°è¡£æœ!)", done: false, cat: "æœ€å„ªå…ˆ" },
        { text: "ä¿®æ”¹ VJW è³‡æ–™ (å¡«å…¥é£¯åº—åœ°å€)", done: false, cat: "å¿…å‚™" },
        { text: "æª¢æŸ¥è­·ç…§æ•ˆæœŸ (6å€‹æœˆä»¥ä¸Š)", done: false, cat: "å¿…å‚™" },
        { text: "å…æ´—å…§è¤²/ä¸€èˆ¬å…§è¤² (ç©¿åœ¨ç™¼ç†±è¤²å…§)", done: false, cat: "å¿…å‚™" },
        { text: "æˆªåœ–ï¼šé£¯åº—è¨‚æˆ¿ç´€éŒ„ã€é£¯åº—é›»è©±", done: false, cat: "å¿…å‚™" },
        { text: "è²·ç¶²å¡/é–‹æ¼«éŠ", done: false, cat: "ç¶²è·¯" },
        { text: "æ›æ—¥å¹£ & æº–å‚™ä¿¡ç”¨å¡", done: false, cat: "éŒ¢åŒ…" },
        { text: "ç™¼ç†±è¤² (Uniqloè¶…æ¥µæš–x1)", done: false, cat: "è¡£ç‰©" },
        { text: "ç™¼ç†±è¡£ (Uniqloè¶…æ¥µæš–x1)", done: false, cat: "è¡£ç‰©" },
        { text: "åŠ çµ¨æ£‰è¤² (ç©¿è‘—å»)", done: false, cat: "è¡£ç‰©" },
        { text: "äº®è‰²åœå·¾ (æ‹ç…§ç”¨)", done: false, cat: "è¡£ç‰©" },
        { text: "ç¾½çµ¨å¤–å¥— (è“‹å±è‚¡)", done: false, cat: "è¡£ç‰©" },
        { text: "é˜²æ°´é›ªé´ + åšè¥ªå­", done: false, cat: "è¡£ç‰©" },
        { text: "æ‰‹å¥—ã€æ¯›å¸½", done: false, cat: "è¡£ç‰©" },
        { text: "èº«é«”ä¹³æ¶²ã€è­·å”‡è†", done: false, cat: "ä¿é¤Š" },
        { text: "è¡Œå‹•é›»æº (æ”¾éš¨èº«åŒ…)", done: false, cat: "éš¨èº«" },
        { text: "æ„Ÿå†’è—¥/æ­¢ç—›è—¥", done: false, cat: "éš¨èº«" }
    ];

    // DOM Elements
    const itemList = document.getElementById('itemList');
    const input = document.getElementById('itemInput');
    const addBtn = document.getElementById('addBtn');
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progressText');
    const modal = document.getElementById('confirmModal');
    const loadingOverlay = document.getElementById('loadingOverlay');
    const cloudStatus = document.getElementById('cloudStatus');

    let currentUser = null;
    let localItems = [];

    // 4. Authentication & Data Listener
    onAuthStateChanged(auth, async (user) => {
        if (user) {
            currentUser = user;
            cloudStatus.innerText = "â˜ï¸ å·²é€£ç·š";
            addBtn.disabled = false;
            
            // Listen to data
            const q = query(collection(db, 'users', user.uid, 'checklist'), orderBy('createdAt', 'desc'));
            
            onSnapshot(q, async (snapshot) => {
                localItems = [];
                snapshot.forEach((doc) => {
                    localItems.push({ id: doc.id, ...doc.data() });
                });

                // If empty (first login), load defaults
                if (localItems.length === 0 && !snapshot.metadata.hasPendingWrites) {
                     await loadDefaults(user.uid);
                } else {
                    render(localItems);
                    loadingOverlay.style.display = 'none';
                }
            });

        } else {
            // Sign in anonymously if not signed in
            try {
                await signInAnonymously(auth);
            } catch (error) {
                console.error("Auth Error:", error);
                alert("é€£ç·šå¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯");
            }
        }
    });

    // Helper: Load Defaults
    async function loadDefaults(uid) {
        const batch = writeBatch(db);
        for (let i = defaultData.length - 1; i >= 0; i--) {
            const item = defaultData[i];
            const docRef = doc(collection(db, 'users', uid, 'checklist'));
            batch.set(docRef, { ...item, createdAt: serverTimestamp() });
        }
        await batch.commit();
    }

    // 5. Render
    function render(items) {
        itemList.innerHTML = '';
        let completedCount = 0;

        items.forEach((item) => {
            if(item.done) completedCount++;
            
            const li = document.createElement('li');
            li.className = item.done ? 'completed' : '';
            
            li.innerHTML = `
                <div class="check-area" onclick="toggleItem('${item.id}', ${item.done})">
                    <div class="custom-checkbox"></div>
                    <div class="item-text-wrapper">
                        ${item.cat ? `<span class="tag ${item.cat === 'æœ€å„ªå…ˆ' ? 'urgent' : ''}">${item.cat}</span>` : ''}
                        <span class="text">${item.text}</span>
                    </div>
                </div>
                <button class="delete-btn" onclick="deleteItem('${item.id}')">Ã—</button>
            `;
            itemList.appendChild(li);
        });

        const percent = items.length === 0 ? 0 : Math.round((completedCount / items.length) * 100);
        progressBar.style.width = percent + '%';
        progressText.innerText = `æº–å‚™é€²åº¦ï¼š${percent}%`;
    }

    // 6. Actions (Interact with Firestore)
    window.toggleItem = async (id, currentStatus) => {
        if(!currentUser) return;
        const itemRef = doc(db, 'users', currentUser.uid, 'checklist', id);
        await updateDoc(itemRef, { done: !currentStatus });
    }

    window.deleteItem = async (id) => {
        if(!currentUser) return;
        if(confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹é …ç›®å—ï¼Ÿ')) {
            await deleteDoc(doc(db, 'users', currentUser.uid, 'checklist', id));
        }
    }

    async function addItem() {
        if(!currentUser) return;
        const text = input.value.trim();
        if (text) {
            await addDoc(collection(db, 'users', currentUser.uid, 'checklist'), {
                text: text,
                done: false,
                cat: "æ–°å¢",
                createdAt: serverTimestamp()
            });
            input.value = '';
        }
    }

    // Modal & Reset Logic
    window.showResetModal = () => modal.style.display = 'flex';
    window.closeModal = () => modal.style.display = 'none';
    
    window.confirmReset = async () => {
        if(!currentUser) return;
        closeModal();
        loadingOverlay.style.display = 'flex';
        loadingOverlay.innerHTML = "<h2>ğŸ”„ é‡ç½®ä¸­...</h2>";
        
        // Delete all existing
        const q = query(collection(db, 'users', currentUser.uid, 'checklist'));
        const snapshot = await getDocs(q);
        const batch = writeBatch(db);
        snapshot.forEach(doc => {
            batch.delete(doc.ref);
        });
        await batch.commit();
        
        setTimeout(() => {
             loadingOverlay.style.display = 'none';
        }, 1500);
    }

    // Tab Logic
    window.switchTab = function(tabName) {
        document.querySelectorAll('.view').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
        document.getElementById(`view-${tabName}`).classList.add('active');
        
        const btns = document.querySelectorAll('.tab-btn');
        if(tabName === 'checklist') btns[0].classList.add('active');
        else btns[1].classList.add('active');
    }

    // Init
    addBtn.addEventListener('click', addItem);
    input.addEventListener('keypress', (e) => { if (e.key === 'Enter') addItem(); });
    modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });

</script>
</body>
</html>
